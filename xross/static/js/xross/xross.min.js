/**
 * django-xross
 * https://github.com/idlesign/django-xross
 *
 * Distributed under BSD License.
 */
xross={_handlers_registry:{},_default_handler:"ajax",data_items_prefix:"x",debug:!1,automate:function(e,t){void 0===e&&(e="xross"),$(function(){$.each($("."+e),function(e,n){xross.describe("#"+$(n).attr("id"),t)})})},bootstrap:function(){this.register_handler("ajax",this.handlers.ajax)},register_handler:function(e,t,n){"object"==typeof t&&(n=t.params,t=t.func),void 0===n&&(n={}),this.utils.log(function(){return"Registering `"+e+"` handler."}),this._handlers_registry[e]={func:t,params:n}},describe:function(e,t,n){"string"!=typeof t&&(n=t,t=this._default_handler),void 0===n&&(n={});var r=this._handlers_registry[t];if(void 0===r){if(t!==this._default_handler)throw{message:"You are trying to use an unregistered handler:  `"+r+"`."};xross.bootstrap(),r=this._handlers_registry[t]}$(function(){e instanceof Array||(e=[e]),$.each(e,function(e,o){xross.utils.log(function(){return"Describing `"+o+"` using `"+t+"` handler."}),r.func(o,$.extend({},r.params,n))})})},utils:{evaluate:function(e,t){return e instanceof Function?e(t):e},log:function(e){xross.debug&&console.log("xross: "+e())},get_function:function(e,t){for(var n=e.split("."),r=n.pop(),o=0;o<n.length;o++)if(t=t[n[o]],void 0===t)return void xross.utils.log(function(){return"Unable to find `"+e+"` function."});return t[r]},get_element_data:function(e){var t={},n=xross.data_items_prefix;return $.each(e.data(),function(e,r){var o=typeof r;("string"==o||"number"==o||"boolean"==o)&&(e.slice(0,n.length)==n&&(e=e.slice(n.length)),t[e]=r)}),t}},handlers:{ajax:{func:function(e,t){var n=e,r=$(e),o=r.attr("id");if(t.op&&(o=t.op),t=$.extend({},t,xross.utils.get_element_data(r)),"auto"===t.event&&(t.event="ready",r.length)){var i=r.prop("tagName").toLowerCase(),s={button:"click",a:"click"},u=s[i];void 0!==u&&(t.event=u)}if("ready"===t.event){if(!r.length)return void xross.utils.log(function(){return"Skipping binding `ready` for not found `"+e+"` element."});n={}}if("string"==typeof t.target)if("this"===t.target)t.target=e;else{var a="#"+t.target;t.target=function(){return $(a)}}if("string"==typeof t.complete&&(t.complete=xross.utils.get_function(t.complete,window)),"string"==typeof t.success){var l=t.success,c=xross.utils.get_function(l,{remove:function(e,t,n,r){r.remove()},empty:function(e,t,n,r){r.empty()},fill:function(e,t,n,r){r.html(e)},replace:function(e,t,n,r){r.replaceWith(e)},append:function(e,t,n,r){r.append(e)},prepend:function(e,t,n,r){r.prepend(e)}});void 0===c&&(c=xross.utils.get_function(l,window)),t.success=function(n,o,i){xross.utils.log(function(){return"Running `"+l+"` success function for `"+e+"` element."}),c(n,o,i,$(xross.utils.evaluate(t.target,r)))}}if("string"==typeof t.error){var f=t.error,g=xross.utils.get_function(f,{log:function(e,t,n){xross.utils.log(function(){return"Request failed `"+n+"`: `"+e.responseText+"`."})}});void 0===g&&(g=xross.utils.get_function(f,window)),t.error=function(t,n,r){xross.utils.log(function(){return"Running `"+f+"` error function for `"+e+"` element."}),g(t,n,r)}}xross.utils.log(function(){return"Binding `"+t.event+"` for `"+e+"`."}),$(document).on(t.event,n,function(n){var r=$.extend({},{op:o},xross.utils.get_element_data($(e))),i=null;xross.utils.log(function(){return"Triggering `"+t.event+"` for `"+e+"` with `"+$.param(r)+"`."}),t.form&&(i="string"==typeof t.form?$("#"+t.form):t.form,i.length&&(r=$.param(r)+"&"+i.serialize())),$.ajax({type:t.method,data:r,success:t.success,error:t.error,complete:t.complete,cache:!1}),n.preventDefault()})},params:{method:"GET",event:"auto",target:"this",success:"fill",error:"log",complete:null,form:null,op:null}}}};