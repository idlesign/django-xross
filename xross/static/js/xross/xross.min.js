/**
 * django-xross
 * https://github.com/idlesign/django-xross
 *
 * Distributed under BSD License.
 */
xross={_handlers_registry:{},_default_handler:"ajax",data_items_prefix:"x",debug:false,automate:function(e,t){if(e===undefined){e="xross"}$(function(){$.each($("."+e),function(e,n){xross.describe("#"+$(n).attr("id"),t)})})},bootstrap:function(){this.register_handler("ajax",this.handlers.ajax)},register_handler:function(e,t,n){if(typeof t==="object"){n=t.params;t=t.func}if(n===undefined){n={}}this.utils.log(function(){return"Registering `"+e+"` handler."});this._handlers_registry[e]={func:t,params:n}},describe:function(e,t,n){if(typeof t!=="string"){n=t;t=this._default_handler}if(n===undefined){n={}}var r=this._handlers_registry[t];if(r===undefined){if(t===this._default_handler){xross.bootstrap();r=this._handlers_registry[t]}else{throw{message:"You are trying to use an unregistered handler:  `"+r+"`."}}}$(function(){if(!(e instanceof Array)){e=[e]}$.each(e,function(e,i){xross.utils.log(function(){return"Describing `"+i+"` using `"+t+"` handler."});r.func(i,$.extend({},r.params,n))})})},utils:{evaluate:function(e,t){if(e instanceof Function){return e(t)}return e},log:function(e){if(xross.debug){console.log("xross: "+e())}},get_function:function(e,t){var n=e.split("."),r=n.pop();for(var i=0;i<n.length;i++){t=t[n[i]];if(t===undefined){xross.utils.log(function(){return"Unable to find `"+e+"` function."});return undefined}}return t[r]},get_element_data:function(e){var t={},n=xross.data_items_prefix;$.each(e.data(),function(e,r){var i=typeof r;if(i=="string"||i=="number"||i=="boolean"){if(e.slice(0,n.length)==n){e=e.slice(n.length)}t[e]=r}});return t}},handlers:{ajax:{func:function(e,t){var n=e,r=$(e),i=r.attr("id");if(t.op){i=t.op}t=$.extend({},t,xross.utils.get_element_data(r));if(t.event==="auto"){t.event="ready";if(r.length){var s=r.prop("tagName").toLowerCase(),o={button:"click",a:"click"},u=o[s];if(u!==undefined){t.event=u}}}if(t.event==="ready"){if(!r.length){xross.utils.log(function(){return"Skipping binding `ready` for not found `"+e+"` element."});return}n={}}if(typeof t.target==="string"){if(t.target==="this"){t.target=e}else{var a="#"+t.target;t.target=function(){return $(a)}}}if(typeof t.complete==="string"){t.complete=xross.utils.get_function(t.complete,window)}if(typeof t.success==="string"){var f=t.success,l=xross.utils.get_function(f,{fill:function(e,t,n,r){r.html(e)},replace:function(e,t,n,r){r.replaceWith(e)},append:function(e,t,n,r){r.append(e)},prepend:function(e,t,n,r){r.prepend(e)}});if(l===undefined){l=xross.utils.get_function(f,window)}t.success=function(n,i,s){xross.utils.log(function(){return"Running `"+f+"` success function for `"+e+"` element."});l(n,i,s,$(xross.utils.evaluate(t.target,r)))}}if(typeof t.error==="string"){var c=t.error,h=xross.utils.get_function(c,{log:function(e,t,n){xross.utils.log(function(){return"Request failed `"+n+"`: `"+e.responseText+"`."})}});if(h===undefined){h=xross.utils.get_function(c,window)}t.error=function(t,n,r){xross.utils.log(function(){return"Running `"+c+"` error function for `"+e+"` element."});h(t,n,r)}}xross.utils.log(function(){return"Binding `"+t.event+"` for `"+e+"`."});$(document).on(t.event,n,function(n){var r=$.extend({},{op:i},xross.utils.get_element_data($(e))),s=null;xross.utils.log(function(){return"Triggering `"+t.event+"` for `"+e+"` with `"+$.param(r)+"`."});if(t.form){if(typeof t.form==="string"){s=$("#"+t.form)}else{s=t.form}if(s.length){r=$.param(r)+"&"+s.serialize()}}$.ajax({type:t.method,data:r,success:t.success,error:t.error,complete:t.complete,cache:false,dataType:"html"});n.preventDefault()})},params:{method:"GET",event:"auto",target:"this",success:"fill",error:"log",complete:null,form:null,op:null}}}}